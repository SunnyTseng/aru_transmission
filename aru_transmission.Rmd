---
title: "ARU cardinal transmission"
author: "Sunny Tseng"
date: "2023-02-07"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## Library

```{r, message = FALSE}
library(here)
library(tidyverse)
```


## Import data

```{r, message = FALSE}
data <- read_csv(here("cardinal_playback.csv"))

```



```{r}
# have a brief check for the imported data. 
data
```


```{r}
# filter out non-necessary data and standardize the object type.
data_clean <- data %>%
  filter(distance != 0) %>%
  mutate(beaufort = as_factor(beaufort),
         distance = as_factor(distance),
         song_exp = as_factor(song_exp)) 
data_clean
```



## Data visualization

Email from Ken: I was simply trying to run a boxplot to look at the data with the three distances (50, 75 & 100) on the X axes, and Detection Confidence on the Y axes, with the Forest, Control and Partial Cut treatments as separate boxes.  I was then trying to insert a line on top of each so I could see how confidence decreased with distance, and also be able to see how the forest treatment affected overall confidence at each distance.  The second ggplot was the closest I could come to what I was trying to achieve, but it is a really weird way to have to get the visual!   Maybe distance has to be a factor for this to work instead of an integer?  Just not sure that would have the X axes spread out in a proper linear fashion. 

```{r, warning = FALSE, message = FALSE}
data_clean_med <- data_clean %>% 
  group_by(distance, plot_type) %>%
  summarize(median_confidence = median(confidence)) %>%
  mutate(distance = as.numeric(distance)) 
# transforming the distance to numeric in order to fit the lm, 
# since 50, 75 and 100 are with the same interval so it's okay in this case. 
# another method (less flexible): 
# lm(median_confidence ~ distance %>% as.numeric(), data = .) %>% 
# coef()

aru_distance <- data_clean %>%
  ggplot() +
    geom_boxplot(aes(x = distance, y = confidence)) +
    geom_smooth(aes(x = distance, y = median_confidence), method = "lm", se = FALSE, data = data_clean_med) +
    facet_grid(rows = vars(plot_type)) +
    theme_bw()
    
aru_distance

```

## Model formulation












